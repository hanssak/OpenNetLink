@using System.Collections.Generic
@using Microsoft.JSInterop

@inject IJSRuntime JSRuntime
@inject WebWindow Window
@inject ISGAppManagerService SGAppMgrSvc
@inject ISGAppUpdaterService SGAppUpdaterSvc

@implements IDisposable

<!-- Control Sidebar -->
    <!-- Control sidebar content goes here -->

    <SGCtrlSideUI CtrlSideUISvc="@CtrlSideUISvc" AppConfigSvc="@AppConfigSvc" OpConfigSvc="@OpConfigSvc" VersionConfigSvc="@VersionConfigSvc" NetWorkSvc="@NetWorkSvc" AppUpdaterSvc="@SGAppUpdaterSvc" />

<!-- /.Control Sidebar -->

@code
{
    ISGCtrlSideUIService CtrlSideUISvc { get; set; }
    ISGAppConfigService AppConfigSvc { get; set; }
    ISGopConfigService OpConfigSvc { get; set; }
    ISGVersionConfigService VersionConfigSvc { get; set; }
    ISGNetworkService NetWorkSvc { get; set; }

    protected override void OnInitialized()
    {
        CtrlSideUISvc = SGAppMgrSvc.CtrlSideUIService;
        AppConfigSvc = SGAppMgrSvc.AppConfigInfoService;
        OpConfigSvc = SGAppMgrSvc.OpConfigInfoService;
        VersionConfigSvc = SGAppMgrSvc.VersionConfigInfoService;
        NetWorkSvc = SGAppMgrSvc.NetworkInfoService;
        CtrlSideUISvc.OnChangeCtrlSide += StateHasChanged;
        
        //Tray로 이동 같은 경우 무조건 GroupId 0 번째를 따른다. 다중망일때 셋팅을 같이
        Window.SetTrayUse(AppConfigSvc.GetExitTrayMove());
    }

    public void Dispose()
    {
        CtrlSideUISvc.OnChangeCtrlSide -= StateHasChanged;
    }

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if(firstRender)
        {
            await base.OnAfterRenderAsync(firstRender);
            //StateHasChanged();
        }
    }
}
